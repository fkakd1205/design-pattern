# State Pattern
###### - 상태를 클래스로 표현하기
<br />

### 내용 정리

'상태'를 클래스로 표현하는 방법.

'상태'를 클래스로 표현하면 클래스를 교체해서 '상태의 변화'를 표현할 수 있고, 새로운 상태를 추가해야 될 때 무엇을 프로그램하면 좋을지 분명해진다.

상태전환은 상태를 나타내고 있는 클래스의 인스턴스를 교체해서 표현한다.

만약, State패턴을 사용하지 않는다면 상태 검사를 위해 다중 분기문으로 짜야하는 불편함이 있다.

* 예제 프로그램에서 State 패턴 사용 하지 않았을 때, pseudo code
<pre><code>
  class 금고경비시스템{
      금고 사용시에 호출되는 메소드() {
        if(주간){
            경비센터에 이용기록
        }else if(야간){
            경비센터에 비상사태 통보
        }
      }
      
      일반 통화시에 호출되는 메소드() {
          if(주간){
              경비센터 호출
          }else if(야간){
              경비센터의 자동응답기 호출
          }
      }
      
      ...
      
  }
</code></pre>
* 예제 프로그램에서 State 패턴 사용 했을 때, pseudo code
<pre><code>
  주간상태를 표현하는 클래스{
      금고 사용시에 호출되는 메소드() {
            경비센터에 이용기록
      }
      
      일반 통화시에 호출되는 메소드() {
          경비센터의 호출
      }
      
      ...
      
  }
  </code></pre>
  <pre><code>
  야간 상태를 표현하는 클래스 {
      금고 사용시에 호출되는 메소드() {
            경비센터에 비상사태 통보
      }
      
      일반 통화시에 호출되는 메소드() {
          경비센터의 자동응답기 호출
      }
      
      ...
      
  }
</code></pre>

-> 시스템의 각 상태를 개별 클래스로 표현하는 패턴.

<br />

### 실습
* [예제](./State_Sample) - 시간마다 경비 상태가 변화하는 금고경비 시스템. (시간 경과를 표현하기 위해 프로그램 상의 1초를 현실 세계의 1시간으로 가정)
* [문제3](./State_A3) - 예제와 동일하게 작동하며, '점심시간'(12:00 ~ 12:59)을 추가. (NoonState)
   - 금고 사용 시 경비센터에 비상사태 통보.
   - 비상벨 사용 시 경비센터에 비상벨 통보.
   - 전화 사용 시 경비센터의 자동응답기 호출.
* [문제4](./State_A4) - 예제와 동일하게 작동하며, '비상사태'라는 새로운 상태를 추가. (UrgetState)
   - 비상벨 누르면 비상사태로 전환.
   - 금고 사용 시 경비센터에 비상사태 통보. (시간에 상관없이)
   - 비상벨 사용시 비상벨 통보. (시간에 상관없이)
   - 전화 사용 시 경비센터가 호출. (시간에 상관없이)
   - 이 사양의 문제점은 일단 비상사태로 전환된 후, 원래의 상태로 복원하는 수단이 없다.
<br />

### Class UML Diagram
<img src="https://user-images.githubusercontent.com/35367660/119927446-68e83900-bfb4-11eb-8874-adb6cbfeadd7.png" width="600">
<br />    

* State(상태) - 상태가 변할 때마다 다른 동작을 하는 인터페이스(API)를 결정
* ConcreteState(구체적인 상태) - State 역할로 결정되는 인터페이스(API)를 구체적으로 표현
* Context(상황, 전후관계, 문맥) - 현재의 상태를 나타내는 ConcreteContext 역할을 포함한다. State 패턴의 이용자에게 필요한 인터페이스(API)를 결정
<br>

### 참고 자료     
* Divide and Conquer (분할해서 통치해라)
  - 문제를 간단하게 해결할 때까지 작게 나누어서 해결하라는 방침.
  - 규모가 크고 복잡한 문제는 작은 문제로 나누고, 그래도 해결하기 힘들면 더 작은 문제로 나눈다.
* 예제 프로그램에서 Context를 인터페이스가 아닌 추상 클래스로 표현할 수 있나? NO.
  - why? SafeFrame 클래스는 이미 Frame클래스의 하위 클래스로 되어 있음. 따라서 Context는 인터페이스로 표현해야 한다. (Java는 다중 상속을 지원하지 않기 때문)
